<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="../Home/css/header.css">
    <link rel="stylesheet" href="../Home/css/footer.css">
    <link rel="stylesheet" href="css/search_results_page.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>
    <script src="../Home/javascript/header_background.js"></script>

    <title>BuenoSpace</title>
</head>

<body>
    <header id="header"></header>

    <div class="search-results-wrapper">
        <!--Search filter menu-->
        <form action="search_results_logic.php" method="post">
        <div class="search-filter-menu">
            <!--Price filter-->
            <div class="filter-block">
                <div class="filter-type">Price (per day)</div>
                <div class="filter-body">
                    <div class="row-center">
                        <div>RM (min)</div>
                        <input id="min-price" name="min_price" type="number" placeholder="10" min="1"
                            onchange="checkOnChangePrice('min-price')" />
                        <button type="button" id="min-price-add" onclick="changePrice('min-price', 1)">+</button>
                        <button type="button" id="min-price-minus" onclick="changePrice('min-price', -1)">-</button>
                    </div>
                    <div class="row-center">
                        <div>RM (max)</div>
                        <input id="max-price" name="max_price" type="number" placeholder="30000" min="1"
                            onchange="checkOnChangePrice('max-price')" />
                        <button type="button" id="max-price-add" onclick="changePrice('max-price', 1)">+</button>
                        <button type="button" id="max-price-minus" onclick="changePrice('max-price', -1)">-</button>
                    </div>
                </div>
            </div>


            <!--Capacity filter-->
            <div class="filter-block">
                <div class="filter-type">Capacity</div>
                <div class="filter-body">
                    <input id="capacity" name="capacity" type="number" placeholder="1" min="1" onchange="checkOnChangeCapacity()" />
                    <button type="button" id="capacity-add" onclick="changeCapacity(1)">+</button>
                    <button type="button" id="capacity-minus" onclick="changeCapacity(-1)">-</button>
                </div>
            </div>

            <!--Event type filter-->
            <div class="filter-block">
                <div class="filter-type">Event</div>
                <div class="filter-body">
                    <input type="checkbox" value="Annual Dinner" name="events[]">
                    <label>Annual Dinner</label><br>
                    <input type="checkbox" value="Product Launch" name="events[]">
                    <label>Product Launch</label><br>
                    <input type="checkbox" value="Training" name="events[]">
                    <label>Training</label><br>
                    <input type="checkbox" value="Meeting" name="events[]">
                    <label>Meeting</label><br>
                    <input type="checkbox" value="Engagement" name="events[]">
                    <label>Engagement</label><br>
                    <input type="checkbox" value="Exhibition" name="events[]">
                    <label>Exhibition</label><br>
                    <input type="checkbox" value="Photo Shoot" name="events[]">
                    <label>Photo Shoot</label><br>
                    <input type="checkbox" value="Press Conference" name="events[]">
                    <label>Press Conference</label><br>
                    <input type="checkbox" value="Team Building" name="events[]">
                    <label>Team Building</label><br>
                    <input type="checkbox" value="Wedding" name="events[]">
                    <label>Wedding</label><br>
                    <input type="checkbox" value="Birthday Party" name="events[]">
                    <label>Birthday Party</label><br>
                    <input type="checkbox" value="Seminar" name="events[]">
                    <label>Seminar</label><br>
                    <input type="checkbox" value="Auditions" name="events[]">
                    <label>Auditions</label><br>
                    <input type="checkbox" value="Conference" name="events[]">
                    <label>Conference</label><br>
                    <input type="checkbox" value="Video Shoots" name="events[]">
                    <label>Video Shoots</label><br>
                    <input type="checkbox" value="Interviews" name="events[]">
                    <label>Interviews</label><br>
                    <input type="checkbox" value="Virtual Event" name="events[]">
                    <label>Virtual Event</label><br>
                </div>
            </div>

            <!--Location filter-->
            <div class="filter-block">
                <div class="filter-type">Location</div>
                <div class="filter-body">
                    <input type="checkbox" value="Taiping" name="location[]">
                    <label>Taiping</label><br>
                    <input type="checkbox" value="Petaling Jaya" name="location[]">
                    <label>Petaling Jaya</label><br>
                    <input type="checkbox" value="Subang Jaya" name="location[]">
                    <label>Subang Jaya</label><br>
                    <input type="checkbox" value="Sg Buloh" name="location[]">
                    <label>Sg Buloh</label><br>
                    <input type="checkbox" value="Damansara" name="location[]">
                    <label>Damansara</label><br>
                    <input type="checkbox" value="Shah Alam" name="location[]">
                    <label>Shah Alam</label><br>
                    <input type="checkbox" value="Kuala Lumpur" name="location[]">
                    <label>Kuala Lumpur</label><br>
                    <input type="checkbox" value="Ampang" name="location[]">
                    <label>Ampang</label><br>
                    <input type="checkbox" value="Cyberjaya" name="location[]">
                    <label>Cyberjaya</label><br>
                    <input type="checkbox" value="Penang, Georgetown" name="location[]">
                    <label>Penang, Georgetown</label><br>
                    <input type="checkbox" value="Puchong" name="location[]">
                    <label>Puchong</label><br>
                    <input type="checkbox" value="KL Sentral" name="location[]">
                    <label>KL Sentral</label><br>
                    <input type="checkbox" value="Bandar Utama" name="location[]">
                    <label>Bandar Utama</label><br>
                    <input type="checkbox" value="Bukit Bintang" name="location[]">
                    <label>Bukit Bintang</label><br>
                    <input type="checkbox" value="Johor Bahru" name="location[]">
                    <label>Johor Bahru</label><br>
                    <input type="checkbox" value="Kuantan" name="location[]">
                    <label>Kuantan</label><br>
                    <input type="checkbox" value="Ipoh" name="location[]">
                    <label>Ipoh</label><br>
                </div>
            </div>

            <div><button id="filter-button" type="submit">Filter</button></div>
        </div>
        </form>

        <!--Search results area-->
        <div class="search-results-area">
            <!--List of spaces-->
            <ul id="search-result-container"></ul>

            <!--Pagination-->
            <div class="pagination">
                <ul>
                    <a href="#">prev</a>
                    <a href="#">1</a>
                    <a href="#">2</a>
                    <a href="#">3</a>
                    <a href="#">nextt</a>
                </ul>
            </div>
        </div>
    </div>
    
    
    <!-- <footer id="footer"></footer> -->

    <script>
        // Load the page for header and footer using jQuery
        $("#header").load("../Home/header.php");
        $("#footer").load("../Home/footer.html");

        // Allow user to type in numbers only without "+", "-", "." and "e" sign in input type number
        document.getElementById("min-price").addEventListener("keypress", keyAllowInputNum);
        document.getElementById("max-price").addEventListener("keypress", keyAllowInputNum);
        document.getElementById("capacity").addEventListener("keypress", keyAllowInputNum);
        function keyAllowInputNum(event) {
            if (event.which != 8 && event.which != 0 && event.which < 48 || event.which > 57) {
                event.preventDefault();
            }
        };

        // To check for min and max price when user type in the numbers
        function checkOnChangePrice(btnId) {
            var targetInput = document.getElementById(btnId);
            var minPrice = document.getElementById("min-price").value;
            var maxPrice = document.getElementById("max-price").value;
            if ((minPrice == "" && btnId == "max-price") || (maxPrice == "" && btnId == "min-price")) {
                if (checkValueType(targetInput.value) < 1) {
                    targetInput.value = 1;
                }
            } else {
                if (!checkMaxMinPrice(checkValueType(minPrice), checkValueType(maxPrice))) {
                    if (btnId == "min-price") {
                        targetInput.value = maxPrice;
                    } else if (btnId == "max-price") {
                        targetInput.value = minPrice;
                    }
                } else {
                    if (btnId == "min-price" && checkValueType(targetInput.value) < 1) {
                        targetInput.value = 1;
                    }
                }
            }
            if ((minPrice != "") && (maxPrice != "")) {
                console.log("Min price and max price are not null");
                //Filter based on price
                //Take location, event, minprice, maxprice & capacity and query the database
            }
            
        }

        function checkOnChangeCapacity() {
            var targetInput = document.getElementById("capacity");
            if (targetInput.value < 1) {
                targetInput.value = 1;
            }
        }

        // Check and change the price or capacity values using "+" and "-" buttons
        function changePrice(btnId, increment) {
            var targetInput = document.getElementById(btnId);
            var outputValue = changeValue(targetInput.value, increment);
            var minPrice;
            var maxPrice;
            if (btnId == "min-price") {
                minPrice = outputValue;
                maxPrice = document.getElementById("max-price").value;
            } else if (btnId == "max-price") {
                minPrice = document.getElementById("min-price").value;
                maxPrice = outputValue;
            }
            if ((minPrice == "" && btnId == "max-price") || (maxPrice == "" && btnId == "min-price")) {
                targetInput.value = outputValue < 1 ? 1 : outputValue;
            } else {
                minPrice = checkValueType(minPrice);
                maxPrice = checkValueType(maxPrice);
                if (checkMaxMinPrice(minPrice, maxPrice)) {
                    targetInput.value = outputValue < 1 ? 1 : outputValue;
                } else {
                    if (btnId == "min-price") {
                        targetInput.value = maxPrice;
                    } else if (btnId == "max-price") {
                        targetInput.value = minPrice;
                    }
                }
            }
        }

        function changeCapacity(increment) {
            var targetInput = document.getElementById("capacity");
            var newValue = changeValue(targetInput.value, increment);
            targetInput.value = newValue < 1 ? 1 : newValue;
        }

        // To check and change the data type of the input value to integer
        function checkValueType(inputValue) {
            return typeof inputValue === "string" ? (inputValue == "" ? 1 : parseInt(inputValue)) : inputValue;
        }

        // To make sure that min price won't exceed max price
        function checkMaxMinPrice(minPrice, maxPrice) {
            return minPrice > maxPrice ? false : true;
        }

        // Increment or decrement values in the price and capacity sections using "+" and "-" buttons
        function changeValue(inputValue, increment) {
            var newValue = checkValueType(inputValue);
            newValue += increment;
            return newValue;
        }

        var slideIndex = {
            "1-space": 1,
            "2-space": 1,
            "3-space": 1,
            "4-space": 1,
            "5-space": 1,
            "6-space": 1
        }


        // Display multiple images in one space
        function showDivs(key) {
            var imgId = document.getElementById(key);
            if (imgId) {
                var img = imgId.getElementsByClassName("each-img");
                // If the image index more than the image length (when move to right max)
                if (slideIndex[key] > img.length) {
                    slideIndex[key] = 1;
                }
                // If the image index less than the 1 (when move to left max)
                if (slideIndex[key] < 1) {
                    slideIndex[key] = img.length;
                }
                for (var i = 0; i < img.length; i++) {
                    img[i].style.display = "none";
                }
                img[slideIndex[key] - 1].style.display = "flex";
            }
        }

        //Onload
        window.addEventListener("load", function () {
            // Initially, add grey background color to header
            headerInitialGray();

            // Load the images onload
            var targetObserver = document.querySelectorAll(".each-img");
            for (var eachTarget of targetObserver) {
                if (!eachTarget.src) {
                    eachTarget.setAttribute("src", eachTarget.dataset.src);
                }
                // Add listener to all images to link to space details page
                // eachTarget.addEventListener("click", linkSpaceDetail);
            }
        });

    </script>


</body>

</html>